% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/table2pdf.R
\name{table2pdf}
\alias{table2pdf}
\title{Export Table to PDF Format}
\usage{
table2pdf(
  table,
  file,
  orientation = "portrait",
  paper = "letter",
  margins = NULL,
  fit_to_page = TRUE,
  font_size = 8,
  caption = NULL,
  caption_size = NULL,
  format_headers = TRUE,
  variable_padding = FALSE,
  cell_padding = "normal",
  bold_significant = TRUE,
  bold_variables = FALSE,
  p_threshold = 0.05,
  align = NULL,
  indent_groups = FALSE,
  condense_table = FALSE,
  condense_quantitative = FALSE,
  zebra_stripes = FALSE,
  stripe_color = "gray!20",
  dark_header = FALSE,
  show_logs = FALSE,
  ...
)
}
\arguments{
\item{table}{A data.frame, data.table, or matrix to export. Can be output from 
\code{\link{desctable}}, \code{\link{fit}}, \code{\link{uniscreen}}, 
\code{\link{fullfit}}, \code{\link{compfit}}, or any tabular data structure.}

\item{file}{Character string specifying the output PDF filename. Must have 
\code{.pdf} extension. Example: \code{"results.pdf"}, \code{"Table1.pdf"}.}

\item{orientation}{Character string specifying page orientation: 
\itemize{
  \item \code{"portrait"} - Vertical orientation [default]
  \item \code{"landscape"} - Horizontal orientation (recommended for wide tables)
}}

\item{paper}{Character string specifying paper size:
\itemize{
  \item \code{"letter"} - US Letter (8.5" x 11") [default]
  \item \code{"a4"} - A4 (210mm x 297mm)
  \item \code{"legal"} - US Legal (8.5" x 14")
  \item \code{"auto"} - Auto-size to content (no margins, crops to fit)
}}

\item{margins}{Numeric vector of length 4 specifying margins in inches as 
\code{c(top, right, bottom, left)}. Default is \code{c(1, 1, 1, 1)}. 
Ignored when \code{paper = "auto"}.}

\item{fit_to_page}{Logical. If \code{TRUE}, scales table to fit within the 
text width (respects margins). Useful for wide tables that would otherwise 
overflow. Default is \code{TRUE}.}

\item{font_size}{Numeric. Base font size in points. Default is 8. Smaller 
values accommodate more content; larger values improve readability. 
Typical range: 6-12 points.}

\item{caption}{Character string. Optional caption displayed below the table. 
Supports LaTeX formatting for multi-line captions, superscripts, italics, etc. 
See Details for formatting guidance. Default is \code{NULL}.}

\item{caption_size}{Numeric. Caption font size in points. If \code{NULL} (default), 
uses the base \code{font_size}. Set to a specific value (e.g., 6, 7, 8) to 
control caption size independently of table font size. Useful for fitting 
captions on constrained page sizes. Typical range: 6-10 points.}

\item{format_headers}{Logical. If \code{TRUE}, applies automatic formatting 
to column headers: converts underscores to spaces, italicizes statistical 
notation (\emph{n}, \emph{p}), and improves readability. Default is \code{TRUE}.}

\item{variable_padding}{Logical. If \code{TRUE}, adds vertical spacing between 
different variables in the table, creating visual grouping. Particularly 
useful for regression tables with multiple predictors. Default is \code{FALSE}.}

\item{cell_padding}{Character string or numeric specifying vertical padding 
within table cells:
\itemize{
  \item \code{"none"} - No extra padding (most compact)
  \item \code{"normal"} - Standard padding [default]
  \item \code{"relaxed"} - Increased padding
  \item \code{"loose"} - Maximum padding
  \item Numeric value - Custom multiplier (e.g., \code{1.5})
}
Adjusts \code{\\arraystretch} in LaTeX.}

\item{bold_significant}{Logical. If \code{TRUE}, applies bold formatting to 
p-values below the significance threshold, making significant results stand 
out visually. Default is \code{TRUE}.}

\item{bold_variables}{Logical. If \code{TRUE}, variable names are displayed
in bold. Default is \code{FALSE}.}

\item{p_threshold}{Numeric. P-value threshold for bold formatting. Only 
used when \code{bold_significant = TRUE}. Default is 0.05. Common alternatives: 
0.01, 0.10.}

\item{align}{Character string or vector specifying column alignment. Options:
\itemize{
  \item \code{"l"} - Left aligned
  \item \code{"c"} - Center aligned
  \item \code{"r"} - Right aligned
}
If \code{NULL} (default), automatically determines alignment based on content 
(text left, numbers right). Can specify per-column: \code{c("l", "l", "r", "r")}.}

\item{indent_groups}{Logical. If \code{TRUE}, indents factor levels/groups 
under their parent variable using horizontal space, creating a hierarchical 
display. Useful for factor variables in regression tables. Default is \code{FALSE}.}

\item{condense_table}{Logical. If \code{TRUE}, condenses the table by:
\itemize{
  \item Showing only one row per continuous variable (estimate + CI)
  \item Showing only non-reference categories for binary factors
  \item Automatically setting \code{indent_groups = TRUE}
}
Significantly reduces table height. Default is \code{FALSE}.}

\item{condense_quantitative}{Logical. If \code{TRUE}, condenses continuous 
and survival variables into single rows while preserving all categorical 
variable rows (including binary). Only applies to descriptive tables from 
\code{desctable()}. Automatically sets \code{indent_groups = TRUE}. Unlike 
\code{condense_table}, this does not collapse binary categorical variables. 
Default is \code{FALSE}.}

\item{zebra_stripes}{Logical. If \code{TRUE}, applies alternating gray 
background shading to different variables (not individual rows) for improved 
visual grouping and readability. Default is \code{FALSE}.}

\item{stripe_color}{Character string. LaTeX color specification for zebra 
stripes. Default is \code{"gray!20"} (20\% gray). Can use other colors like 
\code{"blue!10"}, \code{"red!15"}. Requires \code{zebra_stripes = TRUE}.}

\item{dark_header}{Logical. If \code{TRUE}, creates a dark (black) background 
with white text for the header row. Provides strong visual contrast. 
Default is \code{FALSE}.}

\item{show_logs}{Logical. If \code{TRUE}, retains LaTeX log and auxiliary 
files after PDF compilation for troubleshooting. If \code{FALSE}, deletes 
these files. Default is \code{FALSE}.}

\item{...}{Additional arguments passed to \code{\link[xtable]{xtable}} for 
advanced LaTeX table customization.}
}
\value{
Invisibly returns \code{NULL}. Creates a PDF file at the specified 
  location. If compilation fails, check the \code{.log} file (if 
  \code{show_logs = TRUE}) for error details.
}
\description{
Converts a data frame, data.table, or matrix to a professionally formatted PDF 
document using LaTeX as an intermediate format. Provides extensive control over 
page layout, typography, and formatting for publication-ready output. Particularly 
well-suited for tables from regression analyses, descriptive statistics, and 
model comparisons.
}
\details{
\strong{LaTeX Requirements:}

This function requires a working LaTeX installation. The function checks for 
LaTeX availability and provides installation guidance if missing.

\emph{Recommended LaTeX distributions:}
\itemize{
  \item \strong{TinyTeX} (lightweight, R-integrated): Install via 
    \code{tinytex::install_tinytex()}
  \item \strong{TeX Live} (comprehensive, cross-platform)
  \item \strong{MiKTeX} (Windows)
  \item \strong{MacTeX} (macOS)
}

\emph{Required LaTeX packages} (auto-installed with most distributions):
\itemize{
  \item fontenc, inputenc - Character encoding
  \item array, booktabs, longtable - Table formatting
  \item graphicx - Scaling tables
  \item geometry - Page layout
  \item pdflscape, lscape - Landscape orientation
  \item helvet - Sans-serif fonts
  \item standalone, varwidth - Auto-sizing (for \code{paper = "auto"})
  \item float, caption - Floats and captions
  \item xcolor, colortable - Colors (for \code{zebra_stripes} or \code{dark_header})
}

\strong{Caption Formatting:}

Captions support LaTeX commands for rich formatting:
\preformatted{
# Multi-line caption with line breaks
caption = "Table 1: Multivariable Analysis\\\\
          OR = odds ratio; CI = confidence interval"

# With superscripts (using LaTeX syntax)
caption = "Table 1: Results\\\\
          Adjusted for age and sex\\\\
          p-values from Wald tests"

# With special characters (must escape percent signs)
caption = "Results for income (in thousands)"
}

\strong{Auto-Sizing (paper = "auto"):}

When \code{paper = "auto"}, the function attempts to create a minimal PDF 
sized exactly to the table content:
\enumerate{
  \item Tries to use the \code{standalone} LaTeX class (cleanest output)
  \item Falls back to \code{pdfcrop} utility if standalone unavailable
  \item Falls back to minimal margins if neither available
}

Auto-sized PDFs are ideal for:
\itemize{
  \item Including in other documents
  \item Flexible embedding in presentations
  \item Maximum space efficiency
}

\strong{Table Width Management:}

For wide tables that don't fit on the page:
\enumerate{
  \item Use \code{orientation = "landscape"}
  \item Use \code{fit_to_page = TRUE} (default) to auto-scale
  \item Reduce \code{font_size} (e.g., 7 or 6)
  \item Use \code{condense_table = TRUE} to reduce columns/rows
  \item Consider \code{paper = "auto"} for maximum flexibility
}

\strong{Optimized for FastFit Tables:}

This function is specifically designed for tables produced by:
\itemize{
  \item \code{\link{desctable}} - Descriptive statistics tables
  \item \code{\link{fit}} - Single model regression tables
  \item \code{\link{uniscreen}} - Univariable screening tables
  \item \code{\link{fullfit}} - Combined univariable/multivariable tables
  \item \code{\link{compfit}} - Model comparison tables
}

The function automatically detects and formats these table types, including:
\itemize{
  \item Sample size rows (N = X)
  \item Variable grouping
  \item P-value highlighting
  \item Proper alignment of estimates and CIs
}

\strong{Troubleshooting:}

If PDF compilation fails:
\enumerate{
  \item Check that LaTeX is installed: Run \code{Sys.which("pdflatex")}
  \item Set \code{show_logs = TRUE} and examine the .log file
  \item Common issues:
    \itemize{
      \item Missing LaTeX packages: Install via package manager
      \item Special characters in text: Escape properly
      \item Very wide tables: Use landscape or reduce font size
      \item Caption formatting: Check LaTeX syntax
    }
}
}
\examples{
\dontrun{
# These examples require a LaTeX installation (pdflatex)
# Install TinyTeX with: tinytex::install_tinytex()

if (nzchar(Sys.which("pdflatex"))) {
  # Load example data and create a regression table
  data(clintrial)
  data(clintrial_labels)
  library(survival)
  
  # Create a regression table
  results <- fit(
      data = clintrial,
      outcome = "os_status",
      predictors = c("age", "sex", "treatment", "stage"),
      labels = clintrial_labels
  )
  
  # Example 1: Basic PDF export
  table2pdf(results, "basic_results.pdf")
  
  # Example 2: Landscape orientation for wide tables
  table2pdf(results, "wide_results.pdf",
          orientation = "landscape")
  
  # Example 3: With caption
  table2pdf(results, "captioned.pdf",
          caption = "Table 1: Multivariable logistic regression results")
  
  # Example 4: Multi-line caption with formatting
  table2pdf(results, "formatted_caption.pdf",
          caption = "Table 1: Risk Factors for Mortality\\\\\\\\
                    aOR = adjusted odds ratio; CI = confidence interval")
  
  # Example 5: Auto-sized PDF (no fixed page dimensions)
  table2pdf(results, "autosize.pdf",
          paper = "auto")
  
  # Example 6: A4 paper with custom margins
  table2pdf(results, "a4_custom.pdf",
          paper = "a4",
          margins = c(0.75, 0.75, 0.75, 0.75))
  
  # Example 7: Larger font for readability
  table2pdf(results, "large_font.pdf",
          font_size = 11)
  
  # Example 8: Indented hierarchical display
  table2pdf(results, "indented.pdf",
          indent_groups = TRUE)
  
  # Example 9: Condensed table (reduced height)
  table2pdf(results, "condensed.pdf",
          condense_table = TRUE)
  
  # Example 10: With zebra stripes
  table2pdf(results, "striped.pdf",
          zebra_stripes = TRUE,
          stripe_color = "gray!15")
  
  # Example 11: Dark header style
  table2pdf(results, "dark_header.pdf",
          dark_header = TRUE)
  
  # Example 12: Combination of formatting options
  table2pdf(results, "publication_ready.pdf",
          orientation = "portrait",
          paper = "letter",
          font_size = 9,
          caption = "Table 2: Multivariable Analysis\\\\\\\\
                    Model adjusted for age, sex, and clinical factors",
          indent_groups = TRUE,
          zebra_stripes = TRUE,
          bold_significant = TRUE,
          p_threshold = 0.05)
  
  # Example 13: Adjust cell padding
  table2pdf(results, "relaxed_padding.pdf",
          cell_padding = "relaxed")  # More spacious
  
  # Example 14: No scaling (natural table width)
  table2pdf(results, "no_scale.pdf",
          fit_to_page = FALSE,
          font_size = 10)
  
  # Example 15: Hide significance bolding
  table2pdf(results, "no_bold.pdf",
          bold_significant = FALSE)
  
  # Example 16: Custom column alignment
  table2pdf(results, "custom_align.pdf",
          align = c("c", "c", "c", "c", "c", "c", "c"))
  
  # Example 17: Descriptive statistics table
  desc_table <- desctable(
      data = clintrial,
      by = "treatment",
      variables = c("age", "sex", "bmi", "stage"),
      labels = clintrial_labels
  )
  
  table2pdf(desc_table, "descriptive.pdf",
          caption = "Table 1: Baseline Characteristics by Treatment Group",
          orientation = "landscape")
  
  # Example 18: Model comparison table
  models <- list(
      base = c("age", "sex"),
      full = c("age", "sex", "bmi", "treatment")
  )
  
  comparison <- compfit(
      data = clintrial,
      outcome = "os_status",
      model_list = models
  )
  
  table2pdf(comparison, "model_comparison.pdf",
          caption = "Table 3: Model Comparison Statistics")
  
  # Example 19: Very wide table with aggressive fitting
  wide_model <- fit(
      data = clintrial,
      outcome = "os_status",
      predictors = c("age", "sex", "race", "bmi", "smoking", 
                    "hypertension", "diabetes", "treatment", "stage")
  )
  
  table2pdf(wide_model, "very_wide.pdf",
          orientation = "landscape",
          paper = "legal",  # Even wider than letter
          font_size = 7,
          fit_to_page = TRUE,
          condense_table = TRUE)

  # Example 20: With caption size control
  table2pdf(results, "caption_size.pdf",
          font_size = 8,
          caption_size = 6,
          caption = "Table 4: Results with Compact Caption\\\\\\\\
                    Smaller caption fits better on constrained pages")

  # Example 21: Troubleshooting - keep logs
  table2pdf(results, "debug.pdf",
          show_logs = TRUE)
  # If it fails, check debug.log for error messages
  } else {
    message("pdflatex not found. Install LaTeX to run these examples.")
    message("Recommended: tinytex::install_tinytex()")
  }
}

}
\seealso{
\code{\link{table2tex}} for LaTeX source files,
\code{\link{table2html}} for HTML output,
\code{\link{table2docx}} for Microsoft Word,
\code{\link{table2pptx}} for PowerPoint,
\code{\link{desctable}} for descriptive tables,
\code{\link{fit}} for regression tables
}
